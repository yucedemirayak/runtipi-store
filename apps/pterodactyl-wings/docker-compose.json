{
  "services": [
    {
      "name": "pterodactyl-wings-perms",
      "image": "alpine:3.21",
      "networkMode": "none",
      "command": [
        "/bin/sh",
        "-c",
        "mkdir -p /var/lib/pterodactyl/volumes /var/lib/pterodactyl/archives /var/lib/pterodactyl/backups && chown 988:988 /var/lib/pterodactyl /var/lib/pterodactyl/volumes /var/lib/pterodactyl/archives /var/lib/pterodactyl/backups && chmod 755 /var/lib/pterodactyl /var/lib/pterodactyl/volumes /var/lib/pterodactyl/archives /var/lib/pterodactyl/backups && tail -f /dev/null"
      ],
      "volumes": [
        { "hostPath": "/var/lib/pterodactyl", "containerPath": "/var/lib/pterodactyl" }
      ]
    },
    {
      "name": "pterodactyl-wings",
      "image": "ghcr.io/pterodactyl/wings:latest",
      "isMain": true,
      "internalPort": 8080,
      "dependsOn": {
        "pterodactyl-wings-perms": { "condition": "service_started" }
      },
      "addPorts": [
        {
          "hostPort": "${TIPI_PTERODACTYL_WINGS_SFTP_PORT}",
          "containerPort": 2022,
          "tcp": true
        }
      ],
      "environment": [
        { "key": "TZ", "value": "${TZ}" }
      ],
      "volumes": [
        { "hostPath": "/var/run/docker.sock", "containerPath": "/var/run/docker.sock" },
        { "hostPath": "/var/lib/docker/containers", "containerPath": "/var/lib/docker/containers", "readOnly": true },
        { "hostPath": "${APP_DATA_DIR}/etc", "containerPath": "/etc/pterodactyl" },
        { "hostPath": "/var/lib/pterodactyl", "containerPath": "/var/lib/pterodactyl" },
        { "hostPath": "${APP_DATA_DIR}/logs", "containerPath": "/var/log/pterodactyl" },
        { "hostPath": "${APP_DATA_DIR}/tmp", "containerPath": "/tmp/pterodactyl" },
        { "hostPath": "${APP_DATA_DIR}/run", "containerPath": "/run/wings" }
      ]
    }
  ],
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json"
}
